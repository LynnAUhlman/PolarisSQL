/*
Lynn Uhlman
Maine InfoNet
Item Counts
*/


SELECT o.Name AS AssignedBranch, sc.Description AS StatisticalCodeName, COUNT(DISTINCT cir.ItemRecordID) AS ItemCount 
FROM CircItemRecords cir WITH (NOLOCK)
INNER JOIN Organizations o WITH (NOLOCK) ON cir.AssignedBranchID = o.OrganizationID
INNER JOIN StatisticalCodes sc WITH (NOLOCK) ON cir.StatisticalCodeID = sc.StatisticalCodeID
WHERE cir.RecordStatusID = 1
  AND cir.ItemStatusID NOT IN (7,10,11)
  AND cir.ILLFlag = 0
GROUP BY o.Name, sc.Description
ORDER BY o.Name, sc.Description;
